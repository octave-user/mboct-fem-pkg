## fem_tests.m:14
%!test
%! try
%! ## TEST 14
%! tol = eps^0.9;
%! mesh.nodes = [                      0                     0                     0                     0                     0                     0
%!                                     0.0200000000000271                     0                     0                     0                     0                     0
%!                                     0.0200000000000271                     0                  0.01                     0                     0                     0
%!                                     0.0199999999999727                  0.02                  0.01                     0                     0                     0
%!                                     0.0230010932944744   0.00727223032069712                     0                     0                     0                     0
%!                                     0.0236002186588899    0.0134544460641435                     0                     0                     0                     0
%!                                     0.00639978134111501   0.00654555393584972                     0                     0                     0                     0
%!                                     0.0031998906705575   0.00327277696792486                     0                     0                     0                     0
%!                                     0.0233006559766821    0.0103633381924203                     0                     0                     0                     0
%!                                     0.0200000000000271                     0                 0.005                     0                     0                     0
%!                                     0.0150000000000021   0.00999999999999402                  0.01                     0                     0                     0
%!                                     0.0236002186588899    0.0134544460641435                  0.01                     0                     0                     0
%!                                     0.0218001093294313    0.0167272230320718                  0.01                     0                     0                     0
%!                                     0.019300109329446    0.0117272230320688                  0.01                     0                     0                     0
%!                                     0.0183765032001916    0.0147985283938626   0.00442070167465085                     0                     0                     0
%!                                     0.0253858140372129    0.0044194172742513   0.00499979173504266                     0                     0                     0
%!                                     0.0167445797465365    0.0044730547330275   0.00500072861704665                     0                     0                     0
%!                                     0.0256603500674828    0.0159474197013384    0.0049792497177231                     0                     0                     0
%!                                     0.00263510354742526   0.00539391676103282   0.00258383947602597                     0                     0                     0
%!                                     0.00551663176184135   0.00268725147164801   0.00256578374471423                     0                     0                     0
%!                                     0.020688798247333    0.0110353793572799   0.00221035083732542                     0                     0                     0
%!                                     0.0166882516000969    0.0123992641969283   0.00721035083732542                     0                     0                     0
%!                                     0.0190005466472383   0.00863611516034557                 0.005                     0                     0                     0
%!                                     0.0233006559766821    0.0103633381924203                 0.005                     0                     0                     0
%!                                     0.0209883609295407    0.0141264872290031   0.00721035083732542                     0                     0                     0
%!                                     0.0040758676546333   0.00404058411634041    0.0025748116103701                     0                     0                     0
%!                                     0.00275831588092067   0.00134362573582401   0.00128289187235711                     0                     0                     0
%!                                     0.00131755177371263   0.00269695838051641   0.00129191973801298                     0                     0                     0
%!                                     0.00451744244427013   0.00596973534844127   0.00129191973801298                     0                     0                     0
%!                                     0.00595820655147818   0.00461640270374886   0.00128289187235711                     0                     0                     0
%!                                     0.0236002186588899    0.0134544460641435                 0.005                     0                     0                     0
%!                                     0.0209883609295407    0.0141264872290031   0.00221035083732542                     0                     0                     0
%!                                     0.0191882516000822    0.0173992641969313   0.00721035083732542                     0                     0                     0
%!                                     0.0246302843631863     0.014700932882741   0.00748962485886155                     0                     0                     0
%!                                     0.0228301750337278    0.0179737098506692   0.00748962485886155                     0                     0                     0
%!                                     0.0220184266338372    0.0153729740476005   0.00469997569618697                     0                     0                     0
%!                                     0.0183722898732818   0.00223652736651375   0.00250036430852333                     0                     0                     0
%!                                     0.0183722898732818   0.00223652736651375   0.00750036430852333                     0                     0                     0
%!                                     0.02269290701862   0.00220970863712565   0.00249989586752133                     0                     0                     0
%!                                     0.02269290701862   0.00220970863712565   0.00749989586752133                     0                     0                     0
%!                                     0.0210651968918747    0.0044462360036394   0.00500026017604466                     0                     0                     0];
%! mesh.elements.tet10 = [   5  15  11  12  21  22  23  24  25  14
%!                           19  20   1   7  26  27  28  29  30   8
%!                           5  15  12   6  21  25  24   9  32  31
%!                           12  15   4  18  25  33  13  34  36  35
%!                           2  17   3  16  37  38  10  39  41  40];
%! E = 210000e6;
%! nu = 0.3;
%! mesh.material_data.rho = 1;
%! mesh.material_data.C = fem_pre_mat_isotropic(E, nu);
%! mesh.materials.tet10 = ones(rows(mesh.elements.tet10), 1, "int32");
%! load_case.locked_dof = false(rows(mesh.nodes), 6);
%! [dof_map] = fem_ass_dof_map(mesh, load_case);
%! [K, ...
%!  M, ...
%!  Mlumped, ...
%!  dm] = fem_ass_matrix(mesh, ...
%!                       dof_map, ...
%!                       [FEM_MAT_STIFFNESS, ...
%!                        FEM_MAT_MASS, ...
%!                        FEM_MAT_MASS_LUMPED, ...
%!                        FEM_SCA_TOT_MASS]);
%! diagM = full(diag(Mlumped));
%! assert_simple(sum(diagM) / 3, dm, tol * dm);
%! assert_simple(diagM(1:3:end), diagM(2:3:end));
%! assert_simple(diagM(1:3:end), diagM(3:3:end));
%! catch
%!   gtest_error = lasterror();
%!   gtest_fail(gtest_error, evalin("caller", "__file"));
%!   rethrow(gtest_error);
%! end_try_catch
